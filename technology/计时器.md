---
date: 2019/12/24
tags:
  - js
issueId: 18
---

# 计时器

```js
export class CountDown {
  /**
   * @param {number} timer - 总时间，单位：毫秒
   * @param {object} [option]
   * @param {number} [option.unit] - 计时间隔，单位：毫秒，默认：1000
   * @param {boolean} [option.auto] - 是否自动开始计时，默认：false
   */
  constructor(timer, option = {}) {
    /**
     * 剩余时间
     * @public
     */
    this.timer = timer;
    /** 总时间 */
    this.totalTime = timer;
    /** setInterval 的 id 用于 clearInterval */
    this.setInterval = null;
    /** 计时间隔，单位：毫秒 */
    this.unit = option.unit || 1000;
    /** 是否自动开始计时 */
    this.auto = option.auto || false;
    if (this.auto) this.start();
  }
  /**
   * 开始计时
   * @public
   */
  start() {
    if (this.setInterval) return;
    this.setInterval = setInterval(() => {
      this.timer -= this.unit;
      if (this.timer <= 0) {
        this.clear();
        this.handle();
      }
    }, this.unit);
  }
  /**
   * 重置计时器
   * @public
   */
  reset() {
    this.clear();
    this.timer = this.totalTime;
    if (this.auto) this.start();
  }
  /**
   * 设置计时为 0 或小于 0 时的触发函数
   * @public
   * @param {Function} handle - 计时为 0 或小于 0 时的触发函数
   */
  setHandle(handle) {
    this.handle = handle;
  }
  /**
   * 停止计时
   * @public
   */
  clear() {
    clearInterval(this.setInterval);
    this.setInterval = null;
  }
}
```
